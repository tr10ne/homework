!function(){"use strict";const t="/api";async function e(){try{const e=await fetch(`${t}/users`);if(200!==e.status)throw new Error("–ü—Ä–æ–±–ª–µ–º—ã —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ö–æ–¥ –æ—Ç–≤–µ—Ç–∞: "+e.status);return await e.json()}catch(t){return console.error("–û—à–∏–±–∫–∞",t),null}}async function n(e){fetch(`${t}/users/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function a(t,e){const n=document.getElementById("notification-container"),a=document.createElement("div");a.className=`notification ${e}`,a.innerText=t,n.appendChild(a),requestAnimationFrame((()=>{a.classList.add("show")})),setTimeout((()=>{a.classList.remove("show"),a.addEventListener("transitionend",(()=>{a.remove()}))}),3e3)}const s={id:""};function i(t){return s.id=t}async function o(){const t=await e();return await t.find((t=>t.id===s.id))}async function c(t){const e=document.querySelector(".tasks"),n=document.createElement("div");n.classList.add("task"),n.dataset.id=t.number;const a=function(t){const e=new Date(t);return`${e.toLocaleDateString()}&emsp;${e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}(t.date);if(n.innerHTML=`\n    <span class="task__date">${a}</span>\n    <div class="task__control">\n    <span class="ok">‚úî</span>\n    <span class="edit">‚úé</span>\n    <span class="del">‚úñ</span>\n    </div>\n    <h2 class="task__title">${t.title}</h2>\n  `,"yes"===t.solved){const t=n.querySelector(".task__title"),e=n.querySelector(".task__date"),a=n.querySelector(".ok");t.style.textDecoration="line-through",e.style.textDecoration="line-through",a.style.display="none"}e.appendChild(n)}async function l(t){const n=await e();(await n.find((e=>e.id===t))).tasks.forEach((t=>{c(t)}))}async function d(){document.querySelector(".tasks").innerHTML=""}const r=document.getElementById("login-form"),u=document.querySelector(".login-page"),y=document.querySelector(".page");r.addEventListener("submit",(async p=>{p.preventDefault(),await async function(n){const s={id:Date.now().toString(),login:n.login.value,pass:n.password.value,tasks:[]};try{const o=await e();if(o.some((t=>t.login===s.login&&t.pass===s.pass)))throw i(o.find((t=>t.login===s.login&&t.pass===s.pass)).id),a(`–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, ${s.login}`,"success");{await async function(e){fetch(`${t}/users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}(s);const o=(await e()).find((t=>t.login===s.login&&t.pass===s.pass));await i(o.id),a(`${s.login} –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –∫–∞–∫ –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å`,"success"),n.reset(),console.log(ok)}}catch(t){console.error(t)}}(r),await async function(t,e,n){e.style.display="none",n.style.display="flex",t.reset()}(r,u,y),await async function(t){await l(t.id);const s=document.getElementById("task-form"),r=document.getElementById("logout-btn");let p=null,m=null;async function f(){const e=document.querySelectorAll(".ok"),a=document.querySelectorAll(".edit"),s=document.querySelectorAll(".del"),i=await o(t.id);e.forEach(((t,e)=>{t.addEventListener("click",(async t=>{p=e,i.tasks[p].solved="yes",await n(i),d(),await l(i.id),f()}))})),a.forEach(((e,a)=>{e.addEventListener("click",(async s=>{const o=e.closest(".task"),c=i.tasks[a],r=o.querySelector(".task__title"),u=o.querySelector(".task__date"),y=document.createElement("span");y.classList.add("save"),y.textContent="üíæ";const p=document.createElement("input");p.type="text",p.value=c.title,r.replaceWith(p);const m=document.createElement("input");m.type="datetime-local",m.value=c.date,u.replaceWith(m),e.replaceWith(y),y.addEventListener("click",(async()=>{c.title=p.value,c.date=m.value,c.solved="no",await n(i),d(),await l(t.id),f()}))}))})),s.forEach(((t,e)=>{t.addEventListener("click",(async t=>{m=e,i.tasks.splice(m,1),await n(i),d(),await l(i.id),f()}))}))}await f(),s.addEventListener("submit",(async a=>{a.preventDefault();const i=t.id;await async function(t,a){const s=await e(),i=await s.find((t=>t.id===a)),o={id:(i.tasks.length+1).toString(),title:t["task-title"].value,date:t["task-date"].value,solved:"no"};i.tasks.push(o),n(i),c(o)}(s,i),s.reset(),f()})),r.addEventListener("click",(async()=>{await async function(t,e){t.style.display="flex",e.style.display="none",a("–î–æ –Ω–æ–≤—ã—Ö –≤—Å—Ç—Ä–µ—á!"),i(""),d()}(u,y)}))}(s)}))}();